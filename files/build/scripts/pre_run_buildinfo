#!/bin/bash

. $BUILDINFO_PATH/config/buildinfo.config

[ -d $DIFF_VERSION_PATH ] && rm -rf $DIFF_VERSION_PATH
mkdir -p $DIFF_VERSION_PATH
chmod a+rw $DIFF_VERSION_PATH

mkdir -p $BUILD_VERSION_PATH
chmod a+rw $BUILD_VERSION_PATH

mkdir -p $LOG_PATH
chmod a+rw $LOG_PATH

[ -d $PRE_VERSION_PATH ] && rm -rf $PRE_VERSION_PATH
collect_version_files $PRE_VERSION_PATH

if [ "$SONIC_ENABLE_VERSION_CONTROL" == "y" ]; then
    [ -f $VERSION_DEB_PREFERENCE ] && cp -f $VERSION_DEB_PREFERENCE /etc/apt/preferences.d/
fi

cp -rf $BUILDINFO_PATH/trusted.gpg.d/* /etc/apt/trusted.gpg.d/

exit 0
